# JewelryRender v2


Установка
-

- Скачать zip-файл с дистрибутивом
- В Blender: User Preferences - Add-ons - Install from File - указать скачанный архив


Использование
-

1. Рядом с сохраненным файлом сцены должен лежать файй с настройками options.json

    Поля заполняются следующим образом:

    "resolution_x", "resolution_y": разрешение итогового рендера

    "samples": самплинг итогового рендера

    "source_obj_dir": полный путь к директории с файлами *.obj

    "rendered_obj_dir": полный путь к директории в которую будут перемещены *.obj после обработки

    "dest_dir": полный путь к директории, в которую будут сохранены готовые рендеры

    "correction":

    - "scale": указание масштаба, который будет пременен к мешам, полученным из  *.obj передр рендером
    - "translate": указание смещения, который будет пременен к мешам, полученным из  *.obj передр рендером
    - "rotate": указание поворота, который будет пременен к мешам, полученным из  *.obj передр рендером

    "cameras": перечень номеров камер, с которых будет производится рендер. Пустое значение - рендер со всех камер сцены.

    "gravi_mesh_name": имя меша-гравировки в файле *.obj

    Файл с настройками редактируется, как обычный текстовый файл.

2. После установки аддона, в Blender в панели Render появляется дополнительная подпанель JewelryRender2

    Нажатие на кнопку Serial Material Render в этой панели запускает обработку файлов *.obj


Создание материалов в сцене
-
Каждый созданный в сцене материал должен иметь в своем имени идентификатор:

Первые 5 символов имени отводятся под идентификатор: 3 буквы, 2 цифры.

Например: MET01_Gold. Здесь MET01 - идентификатор. После пятого символа могут идти любые уточнения для удобства.

Также каждый материал сцены должен иметь фейкового юзера, чтобы отличать их от загруженных при импорте obj.

Каждый материал в сцене, который может быть назначен на меш с гравировкой, должен иметь связку соответствующих нодов для подключения и отключения текстуры гравировки. Микс-нод с именем "Gravi_Mix", который смешивает два материала - основной и материал гравировки по маске текстуры гравировки. Нод с текстурой (подключается на вход Factor микс-нода) с именем "Gravi_Text".

Имя текстуры гравировки должно совпадать с именем obj файла. Расширение png.

Коррекция размеров и положения импортированного меша
-
Значения масштаба задаются в относительных единицах

Значения смещения задаются в единицах сцены.

Значения углов поворота задаются в градусах.

Определение материалов в импортируемом obj
-
Имена всех мешей в obj файле должны начинаться с идентификатора материала. Идентификатор такой же, как для материалов сцены: 3 символа обозначают материал + 2 символа обозначают его номер. Например "Met33".

Для меша с гравировкой после пяти символов материала идут еще 5 символов его специального идентификатора "Gravi". Например "Met01Gravi". После этого идут еще 2 символа - номер текстуры для гравировки.

Пример полного имени меша с гравировкой: Met01Gravi01 

Если номер материала в идентификаторе равен "00" - это меш с переменным материалом. Если номер не нулевой - это меш с постоянным материалом.

# Текстуры гравировки

Имя текстуры должно совпадать с именем файла *.obj. Плюс номер текстуры для гравировки.

Если импортируемый файл имеет имя Ring.obj, текстура для гравировки должна иметь имя Ring01.obj при наличии в сцене меша с гравировкой с именем Met00Gravi01.

Даже если текстура гравировки одна, и меш с гравировкой и текстура должны иметь номер 01.

# Камеры в сцене

Для того, чтобы можно было задавать перечень камер, с которых будет производится ренедер в файле options.json, все камеры должны быть одинаково пронумерованы.

Номером камеры считаются две последние цифры в ее имени.

Например: Camera.01, Camera.34

Если в сцене есть камеры без номера, их невозможно задать в перечне файла options.json.

Камеры для рендера в файле options.json задаются в квадратных скобках через запятую:

    "cameras": [1, 4, 36]

Указание пустого перечня камер в файле options.json означает последовательный рендер со всех камер сцены, даже с тех, у которых нет номера.

    "cameras": []
   
# Материалы в сцене

Подобно камерам в файле options.json возможно указать перечень используемых при рендере материалов (камней и металлов).

Материалы должны быть пронумерованы. Номером материала считаются две последние цифры в его имени.

Например: MET01, GEM34

Материалы для рендера в файле options.json задаются через запятую или диапазонами через тире (без пробелов):

    "mets": "1, 5, 24-28"
    "gems": "1, 6-12, 26, 34"

Перечисление списка обязательно задается внутри двойных кавычек " " чтобы поддерживалось задание диапазонов через тире.

Указание пустого перечня материалов в файле options.json означает последовательный рендер со всеми материалами, присутствующими в сцене.

    "mets": ""
    "gems": ""

# Материалы "*_ads" в сцене

В случае использования секции *_ads в файле options.json нельзя ограничивать материалы в секциях gems и mets (предыдущий параграф)!

В файле options.json предусмотрена секция

	"mets_ads": {
		"01": "",
		"02": ""
	},
	"gems_ads": {
		"01": "",
		"02": "1-2"
	}

Здесь для любых материалов (металлов и камней) с цифровым индексом может быть задано перечисление или диапазон используемых материалов. В этом случае при переборе вариантов рендера для объекта с указанным индексом будет использоваться перебор указанных материлов. 

Например:

    "mets_ads": {
		"01": "1, 3-5",
	},
	
означает, что для объекта Met01 при рендере будут последовательно назначены металлически материалы с индексами 1, 3, 4, и 5.

Если значение пустое

    "mets_ads": {
		"01": "",
	},

оно не учитывается и объекту Met01 всегда назначается материал Met01
